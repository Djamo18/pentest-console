<?

// TODO - Clearly sanitization is needed here. 
// TODO - the script should pick up all the TEMPLATE projects
// TODO - the script should be a bit prettier. somehow going to need to handle this...

$data = $_GET['data'];
$type = $_GET['type'];
//$start = $_GET['start'];
//$end = $_GET['end'];


if (!is_null($start)) {
	echo "Error: start is not defined<br>";
}
if (!is_null($end)) {
	echo "Error: end is not defined<br>";
}

//if (!is_null($type)) {
//        echo "Error: type is not defined<br>";
//}

//if (!is_null($data)) {
//        echo "Error: client is not defined<br>";
//}


if ( !is_null($type) and !is_null($data) ) {
    $input = preg_replace('/\W/', '', $data);
    $input = preg_replace('/%/', '', $data);

    if ( $type == "pentest") {
	       system("../scripts/ptc-createProject.sh TEMPLATEpentest $data", $return);
	}
	else if ($type =="webapp"){
    	       system("../scripts/ptc-createProject.sh TEMPLATEwebapp $data", $return);
	}
	else if ($type =="internalpentest"){
	       system("../scripts/ptc-createProject.sh TEMPLATEinternalPentest $data", $return);
	}
	else if ($type =="topten"){
	       system("../scripts/ptc-createProject.sh TEMPLATEtopten $data", $return);
	}
	else if ($type =="audit"){
	        system("../scripts/ptc-createProject.sh TEMPLATEaudit $data", $return);
	}
	else if ($type =="code") {
		system("../scripts/ptc-createProject.sh TEMPLATEcode $data", $return);
        }
	else if ($type =="physical") {
		system("../scripts/ptc-createProject.sh TEMPLATEphysical $data", $return);
        }
	else { ##Blank Engagement
		system("../scripts/ptc-createProject.sh TEMPLATEblank $data", $return);
	}
	//header( 'Location: https://' . $_SERVER["SERVER_NAME"] . "/projects/$data" ) ;
       echo ('<br/> <br/> <a href="https://' . $_SERVER["SERVER_NAME"] . '/projects/' . $data . '"> Click here to access the ' . $data . ' project. </a>' ); 
   }
    else {
	exit;
    }
?>
