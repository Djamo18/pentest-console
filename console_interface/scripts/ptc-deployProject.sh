#!/bin/bash

PROJECT=$1
PASSWORD=$2

mkdir /tmp/ptc-deploy
mkdir /tmp/ptc-deploy/$PROJECT
mkdir /tmp/ptc-deploy/$PROJECT/checkout
mkdir /tmp/ptc-deploy/$PROJECT/export

svn co file:///var/svn/$PROJECT/trunk/deploy /tmp/ptc-deploy/$PROJECT/checkout
svn export /tmp/ptc-deploy/$PROJECT/checkout /tmp/ptc-deploy/$PROJECT/export

zip -e -r -P $PASSWORD /tmp/ptc-export/$PROJECT /tmp/ptc-export/$PROJECT/export

## TODO, replace with an scp to report deployment box.
# webserver
mkdir /var/www/htdocs/ptc-deploy

cp /tmp/ptc-deploy/$PROJECT.zip /var/www/htdocs/ptc-deploy

echo file is here: http://$HOSTNAME/ptc-deploy/$PROJECT.zip


##rm -rf /tmp/ptc-deploy/$PROJECT
