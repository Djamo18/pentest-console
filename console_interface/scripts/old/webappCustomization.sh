#!/bin/bash
###
#
# webappCustomization.sh
#
###
#
# Owner:        jabra
#               jcran
#
# Purpose:      Do Trac-specific customization for a webApp
#
# Description:
#               - Add WebApp Milestones
#               - Add WebApp Tickets
#               - Set Ticket Resolutions (not implemented)
#               - Load WebApp Wiki Template
#
# History:
#               03/15/08 - Created from start_web_engagement.sh
#		03/25/08 - Added milestones & moved all assessment items into OWASP Assessment ms
#

#Get Arguments
CLIENT=$1
if [ $0 == "sudo" ] ; then
        CLIENT=$2
fi

#echo $CLIENT

#Sanitize Client Name
CLIENT=`echo $CLIENT |perl -p -e 's/\W//g'`

if [ -z $CLIENT  ] ; then
        echo "Client is blank"
        exit 1
fi

RDIR=/var/www/scripts

trac-admin /var/trac/$CLIENT milestone add "Visceral Examination"
trac-admin /var/trac/$CLIENT milestone add "OWASP Assessment"
trac-admin /var/trac/$CLIENT milestone add "Reporting"

# removed on 03/25/08 -jcran
##trac-admin /var/trac/$CLIENT milestone add "Information Gathering"
##trac-admin /var/trac/$CLIENT milestone add "Business Logic Testing"
##trac-admin /var/trac/$CLIENT milestone add "Authentication Testing"
##trac-admin /var/trac/$CLIENT milestone add "Session Management Testing"
##trac-admin /var/trac/$CLIENT milestone add "Data Validation Testing"
##trac-admin /var/trac/$CLIENT milestone add "Testing For Buffer Overflow"
##trac-admin /var/trac/$CLIENT milestone add "Testing for Denial of Service"
##trac-admin /var/trac/$CLIENT milestone add "Web Services Testing"
##trac-admin /var/trac/$CLIENT milestone add "AJAX Testing"


trac-admin /var/trac/$CLIENT ticket add "Visceral Examination" "Visceral Examination" component1

trac-admin /var/trac/$CLIENT ticket add "Testing Web Application Fingerprint" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Application Discovery" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Spidering And Googling" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Analysis Of Error Codes" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Infrastructure Configuration Management Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "SSL-TLS Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "DB Listener Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Application Configuration Management Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For File Extensions Handling" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Old Backup And Unreferenced Files" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Business Logic Testing" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Testing For Guessable User Accounts-Dictionary Attack" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Brute Force Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Bypassing Authentication Schema" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Directory Traversal-File Include" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Vulnerable Remember Password And Password Reset" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Logout Browser Cache Management Testing" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Testing For Session Management Schema" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Cookie And Session Token Manipulation" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Exposed Session Variables" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For CSRF" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For HTTP Exploit" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Testing For Cross Site Scripting" "OWASP Assessment" component1 
trac-admin /var/trac/$CLIENT ticket add "Testing For HTTP Methods XST" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For SQL Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For LDAP Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For ORM Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For XML Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For SSI Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For XPath Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "IMAP-SMTP Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Code Injection" "OWASP Assessment" component1 
trac-admin /var/trac/$CLIENT ticket add "Testing For Command Injection" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Incubated Vulnerabilities" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Code Injection" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Testing For Heap Overflow" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Stack Overflow" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Format String" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Testing For DoS Locking Customer Accounts" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For DoS Buffer Overflows" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For DoS User Specified Object Allocation" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For User Input As A Loop Counter" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Writing User Provided Data To Disk" "OWASP Assessment" component1 
trac-admin /var/trac/$CLIENT ticket add "Testing For DoS Failure To Release Resources" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Writing User Provided Data To Disk" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Storing Too Much Data In Session" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "XML Structural Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "XML Content-Level Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "HTTP GET Parameters-REST Testing" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "Testing For Naughty SOAP Attachments" "OWASP Assessment" component1
trac-admin /var/trac/$CLIENT ticket add "WS Replay Testing" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "AJAX Vulnerabilities" "OWASP Assessment" component1

trac-admin /var/trac/$CLIENT ticket add "Reporting" "Reporting" component1

# set ticket resolution messages
## leaves invalid, and duplicate
#trac-admin /var/trac/$CLIENT resolution remove fixed
#trac-admin /var/trac/$CLIENT resolution remove wontfix
#trac-admin /var/trac/$CLIENT resolution remove worksforme
#trac-admin /var/trac/$CLIENT resolution add vulnfound
#trac-admin /var/trac/$CLIENT resolution add novulnfound
#trac-admin /var/trac/$CLIENT resolution add taskdone
#trac-admin /var/trac/$CLIENT resolution add taskskipped

rm  $RDIR/webapp/wiki/*
trac-admin /var/trac/TEMPLATEwebapp wiki dump $RDIR/webapp/wiki/
trac-admin /var/trac/$CLIENT wiki load $RDIR/webapp/wiki

## Repo Customization (05/08/08)
#Create directories needed
mkdir -p /tmp   #should fail (already exists)
mkdir -p /tmp/$CLIENT/ #should fail (already exists)

cd /tmp/$CLIENT/
svn co file:///var/svn/$CLIENT/ svn
cd svn/trunk
svn export file:///var/svn/TEMPLATEwebapp/
mv -f TEMPLATEwebapp/trunk/* .
rm -Rf TEMPLATEwebapp
svn add * 
svn ci -m "template webapp checkin" *

