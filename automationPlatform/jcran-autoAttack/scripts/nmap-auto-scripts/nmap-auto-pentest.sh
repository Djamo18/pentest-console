#!/bin/bash
## Owner: jcran
## Purpose: automate pentest (nmap aspect)
## Description:
##	1) Set up nmap enviroment
##	2) call nmap scan
##	3) parse nmap results
##
## Notes: Script is run automatically from auto-pentest.sh (Pentest_Scripts)
##

## Let the kids @ home know where we're at in the hierarchy...
## -----------------------------------------------------------
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "CURRENT SCRIPT: $0"
fi

## Set up nmap environment
## -----------------------
export AP_NMAP_RESULT="$AP_RESULT_DIR/scan_quick"
export AP_NMAP_LOG="$AP_LOG_DIR/scan.log"

## DEBUG - Enumerate Environment
## ------------------------------
if [ "$AP_DEBUG" -eq "1" ] 
then
	echo "Setting AP_NMAP_RESULT to" $AP_NMAP_RESULT
	echo "Setting AP_NMAP_LOG to" $AP_NMAP_LOG
fi


if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling nmap-auto-scan.sh"
fi

$AP_NMAP_SCRIPT_DIR/nmap-auto-scan.sh # Call Scanner

if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling nmap-auto-extract.sh"
fi

perl $AP_NMAP_SCRIPT_DIR/nmap-auto-extract.pl #Call XML-Extractor
