#!/bin/bash
## Owner: jcran
## Purpose: automate pentest (nmap aspect)
## Description:
##	1) Run various nmap scans
##
## Notes: Script is run automatically from nmap-auto-pentest.sh (Pentest_Scripts)
##
#Selected Ports Syn Scan (without ping filter)


## Let the kids @ home know where we're at in the hierarchy...
## -----------------------------------------------------------
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "CURRENT SCRIPT: $0"
fi

## DEBUG
if [ "$AP_DEBUG" -eq "1" ] 
then
	echo "Starting nmap scan..."
fi

## Set up a quick SYN scan, so we can work on service specific stuff
nmap -sT -iL $AP_HOST_FILE -p 21,22,23 -P0 -sV -O -vvv -oA $AP_RESULT_DIR/scan_quick > ${AP_NMAP_LOG}_QUICK

## Set up a quick SYN scan
## nmap -sS -iL $AP_HOST_FILE -P0 -sV -O -vvv --traceroute -oA $AP_RESULT_DIR/scan_default_syn > ${AP_NMAP_LOG}_DEFAULT_SYN &

## Set up a quick Full-connect scan
## nmap -sT -iL $AP_HOST_FILE -P0 -sV -O -vvv -oA $AP_RESULT_DIR/scan_default_fullconnect > ${AP_NMAP_LOG}_DEFAULT_FULLCONNECT & 

## Set up a quick scan using the source port 25, so we can work on service specific stuff
## nmap -sS -iL $AP_HOST_FILE -P0 -sV -g 25 -O -vvv  -oA $AP_RESULT_DIR/scan_quick_25 > ${AP_NMAP_LOG}_DEFAULT_25_SYN

## Set up a quick scan using the source port 80, so we can work on service specific stuff
## nmap -sS -iL $AP_HOST_FILE -P0 -sV -g 80 -O -vvv -oA $AP_RESULT_DIR/scan_quick_80 > ${AP_NMAP_LOG}_DEFAULT_80_SYN

## Set up a quick scan using the source port 443, so we can work on service specific stuff
## nmap -sS -iL $AP_HOST_FILE -P0 -sV -g 443 -O -vvv -oA $AP_RESULT_DIR/scan_quick_443 > ${AP_NMAP_LOG}_DEFAULT_443_SYN

## Set up a UDP scan
## nmap -sU -iL $AP_HOST_FILE -P0 -sV -O -vvv -oA $AP_RESULT_DIR/scan_udp > ${AP_NMAP_LOG}_UDP

## And a Long-running scan that we can analyze further (later) -- in the background
## nmap -sS -iL $AP_HOST_FILE -p 1-10000 -P0 -A -vvv -oA $AP_RESULT_DIR/scan_10k > ${AP_NMAP_LOG}_10K &

## And a full scan that we can analyze further (later) -- in the background
## nmap -sS -iL $AP_HOST_FILE -p 1-65535  -P0 -A -vvv -oA $AP_RESULT_DIR/scan_complete > ${AP_NMAP_LOG}_COMPLETE &

## DEBUG
if [ "$AP_DEBUG" -eq "1" ] 
then
	echo "Finished with nmap scan..."
fi
