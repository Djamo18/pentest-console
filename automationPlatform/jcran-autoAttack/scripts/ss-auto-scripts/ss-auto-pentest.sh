#!/bin/bash
## Owner: jcran
## Purpose: automate pentest (service-specific aspect)
## Description:
##	1) Set up service specific enviroment
##	2) call each service scan
##
## Notes: Script is run automatically from auto-pentest.sh (Pentest_Scripts)
##

## Let the kids @ home know where we're at in the hierarchy...
## -----------------------------------------------------------
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "CURRENT SCRIPT: $0"
fi

## Sort & Remove Dupes from each ss list
./scripts/ss-auto-scripts/ss-maintenance.sh $AP_RESULT_DIR/services

## Call DNS Scan
## ----------------
AP_CURRENT_SERVICE="DNS"
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling $AP_CURRENT_SERVICE"
fi
./scripts/ss-auto-scripts/ss-auto-dns.sh $AP_RESULT_DIR/services/nmap_dns.list

## Call CIFS Scan
## ----------------
AP_CURRENT_SERVICE="CIFS"
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling $AP_CURRENT_SERVICE"
fi
./scripts/ss-auto-scripts/ss-auto-cifs.sh $AP_RESULT_DIR/services/nmap_cifs.list

## FTP
## ----------------
AP_CURRENT_SERVICE="FTP"
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling $AP_CURRENT_SERVICE"
fi
./scripts/ss-auto-scripts/ss-auto-ftp.sh $AP_RESULT_DIR/services/nmap_ftp.list

## HTTP
## ----------------
AP_CURRENT_SERVICE="HTTP"
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling $AP_CURRENT_SERVICE"
fi
./scripts/ss-auto-scripts/ss-auto-http.sh $AP_RESULT_DIR/services/nmap_http.list

## HTTPS
## ----------------
AP_CURRENT_SERVICE="HTTPS"
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "calling $AP_CURRENT_SERVICE"
fi
./scripts/ss-auto-scripts/ss-auto-https.sh $AP_RESULT_DIR/services/nmap_https.list
