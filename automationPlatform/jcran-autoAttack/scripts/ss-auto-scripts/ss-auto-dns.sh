#!/bin/bash
## Owner: jcran
## Purpose: automate service-specific scan
## Description:
##	1) Set up service enviroment
##	2) Call individual tools from toolkit
##
## Notes: Script is run automatically from ss-auto-pentest.sh (Pentest_Scripts)
##

## Set current service we're scanning (mostly for consistency among service scripts)
export AP_CURRENT_SERVICE="DNS"

## Let the kids @ home know where we're at in the hierarchy...
## -----------------------------------------------------------
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "CURRENT SCRIPT: $0"
fi

## Gather user options
## --------------------
if [ $# -ne 1 ]; then
	echo "Usage: $0 [hostList]"
	exit -1
fi

if [ -s "$1" ]
then
	if [ "$AP_DEBUG" -eq "1" ]
	then	
		echo "$AP_CURRENT_SERVICE HOSTS:\n"
		for i in `cat $1`; do echo "$i\n"; done
	fi
else
	echo "No $AP_CURRENT_SERVICE hosts in $1"
	exit
fi


## FIERCE - Brute
## --------------------------
if [ "$AP_DEBUG" -eq "1" ]
then	
	echo "$0 - calling Fierce"
fi

for i in `cat $1`
do
	if [ "$AP_DEBUG" -eq "1" ]
	then				
		echo "$0 - Fiercing domain on $i for $AP_HOST_DOMAIN"
	fi

	perl $AP_TOOLKIT/nix/recon-net/fierce.pl -dns $AP_HOST_DOMAIN -wordlist $AP_TOOLKIT/wordlist/hosts.list > $AP_RESULT_DIR/ss_dns_fierce_$i 
	##echo "$!" >> $AP_PROJECT_NAME/backgroundJobs
done

## FIERCE - ReverseDNS
## ------------------------
## perl $AP_TOOLKIT/nix/net-recon/fierce.pl/fierce.pl -dns client.com -range EVERYIP


