#!/usr/bin/perl -w

# Joshua Abraham ( jabra@rapid7.com )
# Tue Dec  4 13:16:11 EST 2007
# (C) 2007 Rapid7 LLC
#
use strict;

if ( !defined($ARGV[0]) ) {
    print "Error: Enter a file which you would like to extract the IPs from\n";
    exit;
}
my $file = $ARGV[0];
chomp($file);
if ( !-r $file ){
    print "Error $file doesn't exist or isn't readable\n";
}
system("./nexpose-parse.rb -p 21 $file > nexpose_ftp_list.txt");
system("./nexpose-parse.rb -i $file > nexpose_listip.txt");
system("./nexpose-parse.rb -s ftps $file > nexpose_ftps_list.txt");
system("./nexpose-parse.rb -p 22 $file > nexpose_ssh_list.txt");
system("./nexpose-parse.rb -p 23 $file > nexpose_telnet_list.txt");
system("./nexpose-parse.rb -s telnets $file > nexpose_telnets_list.txt");
system("./nexpose-parse.rb -p 25 $file > nexpose_telnets_list.txt");
system("./nexpose-parse.rb -p 53 $file > nexpose_dns_list.txt");
system("./nexpose-parse.rb -s imap $file > nexpose_imap_list.txt");
system("./nexpose-parse.rb -s imaps $file > nexpose_imaps_list.txt");
system("./nexpose-parse.rb -s pop3 $file > nexpose_pop3_list.txt");
system("./nexpose-parse.rb -p 80 $file > nexpose_http_list.txt");
system("./nexpose-parse.rb -p 443 $file > nexpose_https_list.txt");
system("./nexpose-parse.rb -p 500 $file > nexpose_isakpmd_list.txt");
system("./nexpose-parse.rb -s portmapper $file > nexpose_portmapper_list.txt");
system("./nexpose-parse.rb -p 902 $file > nexpose_vmware_list.txt");
system("./nexpose-parse.rb -p 3389 $file > nexpose_rdesktop_list.txt");
system("./nexpose-parse.rb -s citrix-ica  $file > nexpose_citrix_list.txt");
system("./nexpose-parse.rb -s vnc $file > nexpose_vnc_list.txt");
system("./nexpose-parse.rb -p 139 $file > nexpose_cifs_list.txt");
system("./nexpose-parse.rb -p 139 $file >> nexpose_cifs_list.txt");
system("./nexpose-parse.rb -p 445 $file >> nexpose_cifs_list.txt");
system("./nexpose-parse.rb -s http-vnc $file > nexpose_http-vnc_list.txt");
