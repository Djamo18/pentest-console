#!/usr/bin/perl -w
#
# Joshua Abraham ( jabra@rapid7.com )
# Tue Dec  4 13:16:11 EST 2007
# (C) 2007 Rapid7 LLC
#
use strict;

if ( !defined($ARGV[0]) ) {
    print "Error: Enter a file which you would like to extract the IPs from\n";
    exit;
}
my $file = $ARGV[0];
chomp($file);
if ( !-r $file ){
    print "Error $file doesn't exist or isn't readable\n";
}
system("./nexpose-parse.rb -i $file    > listip.txt");
system("./nexpose-parse.rb -p 21 $file > ftp_list.txt");
system("./nexpose-parse.rb -s ftps $file > ftps_list.txt");
system("./nexpose-parse.rb -p 22 $file > ssh_list.txt");
system("./nexpose-parse.rb -p 23 $file > telnet_list.txt");
system("./nexpose-parse.rb -s telnets $file > telnets_list.txt");
system("./nexpose-parse.rb -p 80 $file > http_list.txt");
system("./nexpose-parse.rb -p 443 $file > https_list.txt");
system("./nexpose-parse.rb -p 500 $file > isakpmd_list.txt");
system("./nexpose-parse.rb -p 902 $file > vmware_list.txt");
system("./nexpose-parse.rb -p 3389 $file > rdesktop_list.txt");
system("./nexpose-parse.rb -s citrix-ica $file > citrix_list.txt");
system("./nexpose-parse.rb -s vnc $file > vnc_list.txt");
system("./nexpose-parse.rb -s cifs $file > cifs_list.txt");
system("./nexpose-parse.rb -s http-vnc $file > http-vnc_list.txt");
system("./nexpose-parse.rb -s portmapper $file > portmapper_list.txt");
system("./nexpose-parse.rb -s imap $file > imap_list.txt");
system("./nexpose-parse.rb -s imaps $file > imaps_list.txt");
system("./nexpose-parse.rb -s pop3 $file > pop3_list.txt");
